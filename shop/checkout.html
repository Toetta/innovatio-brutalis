<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checkout – Innovatio Brutalis</title>
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/shop/shop.css" />
</head>
<body>
  <div class="container">
    <div id="site-topbar"></div>
    <script defer src="/assets/site.js"></script>
    <script defer src="/assets/site-deeplinks.js"></script>

    <main class="shop">
      <section class="shop-surface" aria-label="Checkout">
        <a class="back" href="/shop/">← Tillbaka</a>
        <section class="card">
          <h1 style="margin-top:0">Kassa</h1>
          <p style="margin-top:0; color:var(--text-muted)">Kortbetalning via Stripe.</p>

          <div id="cartSummary" class="badge" style="margin-top:10px">Laddar kundvagn…</div>
          <div id="taxSummary" class="badge" style="margin-top:10px; white-space:pre-line"></div>
          <div id="deliverySummary" class="badge" style="margin-top:10px; white-space:pre-line"></div>

          <form id="startForm" style="margin-top:14px; display:grid; gap:10px">
            <label class="badge" style="display:grid; gap:6px">
              <span>Namn</span>
              <input id="fullName" type="text" autocomplete="name" required />
            </label>

            <label class="badge" style="display:grid; gap:6px">
              <span>Telefon</span>
              <input id="phone" type="tel" autocomplete="tel" inputmode="tel" required />
            </label>

            <label class="badge" style="display:grid; gap:6px">
              <span>E-post</span>
              <input id="email" type="email" autocomplete="email" required />
            </label>

            <label class="badge" style="display:grid; gap:6px">
              <span>Land</span>
              <select id="country" required>
                <option value="SE" selected>Sverige</option>
                <option value="AT">Österrike</option>
                <option value="BE">Belgien</option>
                <option value="BG">Bulgarien</option>
                <option value="HR">Kroatien</option>
                <option value="CY">Cypern</option>
                <option value="CZ">Tjeckien</option>
                <option value="DK">Danmark</option>
                <option value="EE">Estland</option>
                <option value="FI">Finland</option>
                <option value="FR">Frankrike</option>
                <option value="DE">Tyskland</option>
                <option value="GR">Grekland</option>
                <option value="HU">Ungern</option>
                <option value="IE">Irland</option>
                <option value="IT">Italien</option>
                <option value="LV">Lettland</option>
                <option value="LT">Litauen</option>
                <option value="LU">Luxemburg</option>
                <option value="MT">Malta</option>
                <option value="NL">Nederländerna</option>
                <option value="PL">Polen</option>
                <option value="PT">Portugal</option>
                <option value="RO">Rumänien</option>
                <option value="SK">Slovakien</option>
                <option value="SI">Slovenien</option>
                <option value="ES">Spanien</option>
                <option value="NO">Norge</option>
                <option value="GB">Storbritannien</option>
                <option value="US">USA</option>
              </select>
            </label>

            <div id="vatIdWrap" class="badge" style="display:grid; gap:8px" hidden>
              <label style="display:grid; gap:6px">
                <span>VAT-ID (företag inom EU)</span>
                <input id="vatId" type="text" inputmode="text" autocomplete="off" placeholder="Ex: DE123456789" />
              </label>
              <div style="color:var(--text-muted)">
                Ange endast om du handlar som företag inom EU (utanför Sverige). VAT-ID valideras via VIES; vid giltigt VAT-ID tillämpas 0% moms (omvänd skattskyldighet).
              </div>
            </div>

            <fieldset class="badge" style="display:grid; gap:8px; padding:12px">
              <legend style="padding:0 6px">Leverans</legend>
              <label style="display:flex; gap:10px; align-items:center">
                <input type="radio" name="delivery_method" value="pickup" checked>
                <span>Avhämtning (0 kr)</span>
              </label>
              <label style="display:flex; gap:10px; align-items:center">
                <input type="radio" name="delivery_method" value="postnord">
                <span>PostNord frakt (viktbaserat)</span>
              </label>

              <div id="pickupInfo" style="color:var(--text-muted)">
                Avhämtning: Innovatio Brutalis, (adress enligt överenskommelse)
              </div>

              <div id="shippingAddressWrap" style="display:grid; gap:10px" hidden>
                <div style="color:var(--text-muted)">PostNord frakt: leveransadress krävs.</div>

                <label class="badge" style="display:grid; gap:6px">
                  <span>Adress</span>
                  <input id="shipLine1" type="text" autocomplete="shipping street-address" />
                </label>

                <label class="badge" style="display:grid; gap:6px">
                  <span>Adressrad 2 (valfritt)</span>
                  <input id="shipLine2" type="text" autocomplete="shipping address-line2" />
                </label>

                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
                  <label class="badge" style="display:grid; gap:6px">
                    <span>Postnr</span>
                    <input id="shipPostal" type="text" autocomplete="shipping postal-code" />
                  </label>
                  <label class="badge" style="display:grid; gap:6px">
                    <span>Ort</span>
                    <input id="shipCity" type="text" autocomplete="shipping address-level2" />
                  </label>
                </div>

                <label class="badge" style="display:grid; gap:6px">
                  <span>Land (2 bokstäver)</span>
                  <input id="shipCountry" type="text" value="SE" inputmode="text" autocomplete="shipping country" />
                </label>
              </div>
            </fieldset>

            <fieldset id="payMethodBox" class="badge" style="display:grid; gap:8px; padding:12px; width:fit-content; max-width:100%; justify-self:center">
              <legend style="padding:0 6px">Betalmetod</legend>
              <label style="display:flex; gap:10px; align-items:center">
                <input type="radio" name="paymethod" value="stripe" checked>
                <span>Kort (Stripe)</span>
              </label>
              <label id="klarnaOption" style="display:flex; gap:10px; align-items:center" hidden>
                <input type="radio" name="paymethod" value="klarna">
                <span>Klarna (test)</span>
              </label>
            </fieldset>

            <button id="startBtn" class="btn primary" type="submit">Gå till betalning</button>
            <div id="startErr" style="color:var(--text-muted)"></div>
          </form>

          <hr class="sep" style="margin-top:16px">

          <form id="payForm" hidden style="margin-top:14px">
            <div id="payTaxSummary" class="badge" style="margin-bottom:10px; white-space:pre-line"></div>
            <div id="paymentElement"></div>
            <button id="payBtn" class="btn primary" type="submit" style="margin-top:12px">Betala</button>
            <div id="payErr" style="margin-top:8px; color:var(--text-muted)"></div>
          </form>

          <div id="swishBox" hidden style="margin-top:14px"></div>

          <form id="klarnaForm" hidden style="margin-top:14px">
            <div id="klarnaWidget"></div>
            <button id="klarnaBtn" class="btn primary" type="submit" style="margin-top:12px">Betala med Klarna</button>
            <div id="klarnaErr" style="margin-top:8px; color:var(--text-muted)"></div>
          </form>
        </section>
      </section>
    </main>
  </div>

  <script src="https://js.stripe.com/v3/" async></script>
  <script src="https://x.klarnacdn.net/kp/lib/v1/api.js" async></script>
  <script src="/shop/checkout.js"></script>
</body>
</html>
